# Allan Gray Digital Styleguide

- What is it?
- Code style
    - [CSS](code_styles/css)
    - [JavaScript](code_styles/javascript)
    - [HTML](code_styles/html)
    - [Linting](code_styles/linting)
- File Organisation
- Contributing (local dev)

## What is it?
The Allan Gray Digital Styleguide comprises a set of core features and components. These features and components can be used to build custom applications with a UI that is consistent with Allan Gray's core brand.

**Living**

"Living" means that as we add new design components and features, the styleguide should remain up-to-date. Previously, we have found that we have added components to our applications, but not to our styleguide.

**Consistent**

Components and features should be designed and implemented the same way wherever they are used. We want to steer clear of building "custom" or "built-for-a-particular-purpose" components from appearing in our styleguide.

**Reusable**

This extends on consistency. The aim is to create a "base" set of styles that can be extended to create "themes". Components should able to be used in almost any context, without needing deep, nested class hierarchies. A flexible and reusable component is one which neither relies on existing within a certain part of the DOM tree, nor requires the use of specific element types.

**Maintainable**

The components should be as modular as possible. The code style should be standard across the styleguide, so that new and old developers can get up and running all using the same style.

## Code style
Every developer has their own code style. For a style guide to be successful and to meet the mandate above, all the developers (current and future) need to be speaking the same language in the same way.

## File organisation
    code-styles/                # Documentation of our code styles
    dist/                       # Compiled files land up here (after you run `gulp`)
    ├── base/                   # Base compiled assets
    docs/                       # Documentation files (HTML of components etc.)
    src/                        # Source files (CSS, JS, Fonts, etc.)
    ├── base/                   # Base files
    │   ├── fonts/
    │   │   └── icons/
    │   ├── scss/
    │   │   ├── globals/        # All of your global styles
    │   │   ├── typography/     # All of your typography styles
    │   │   ├── variables/      # All of your variables (you will import these in your app components)
    │   │   └── index.scss
    gulpfile.babel.js           # Gulp task configuration
    package.json                # npm dependencies

## Include as a node module
#### Prerequisites
Ensure that your ~/.npmrc file has the following lines, so that it knows to go to artificatory to fetch our packages:
```
strict-ssl=false
registry="https://theluggage-agct.gray.net/artifactory/api/npm/npm-development"
```

#### Installing
```sh
# Install @agct/ag-styleguide and save it as a dependency in the package.json file
npm install @agct/ag-styleguide --save-dev
```

#### Referencing the Sass
- Open `client/app/styles/app.scss`.
- At the top of the file: `@import 'node_modules/@agct/ag-styleguide/src/base/scss/index';`

#### Referencing the CSS
- Open `client/app/index.html` (this is your base template)
- Make sure that you have a `link` element to whatever you named your `APP_NAME.css` above.

## Contributing

#### Prerequisites
- Install Nodejs
- Install gulp-cli: `npm install -g gulp-cli`

#### Run the project (first-time)

Run this from the command line:
```sh
npm install                     # installs the npm packages
gulp                            # Builds the assets, and starts the dev server
```

#### Run the project (subsequent times)

Run from the command line:
```sh
gulp
```

## The build job

#### Prerequisites
Before running the build job, remember to bump the package number and push the tag:

```sh
npm version <major|minor|patch>
git push origin develop --follow-tags
```

#### The build process
  1. On the build server, checkout the code
  2. Install the npm packages:

    ```sh
    git clean -fxd -e node_modules
    npm install
    npm prune --production=false
    ```

  3. Build the assets:

    ```sh
    npm run build
    ```

  4. Publish to artifactory:
    ```sh
    # -s means don't install the node deps (we did it in step 2)
    npm publish
    ```

## But, I'm a BA on Windows!
This guide assumes that you've already installed NodeJS on your computer.

Make a file in `C:\Users\<YOUR_USERNAME>` called `.npmrc` with the following content:
```
strict-ssl=false
registry="https://theluggage-agct.gray.net/artifactory/api/npm/npm-development"
```

Install the Gulp CLI (Gulp is a task-runner. It builds the SG on your computer):
```sh
npm install -g gulp-cli

Install the npm components (required for the style guide):
```sh
npm install
```

Run the `readonly` gulp task:
```sh
gulp readonly
```
