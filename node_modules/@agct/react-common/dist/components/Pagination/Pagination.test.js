(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(['react', 'chai', 'enzyme', 'chai-enzyme', 'sinon-chai', '@agct/reacceptance/src/qa', './Pagination'], factory);
  } else if (typeof exports !== "undefined") {
    factory(require('react'), require('chai'), require('enzyme'), require('chai-enzyme'), require('sinon-chai'), require('@agct/reacceptance/src/qa'), require('./Pagination'));
  } else {
    var mod = {
      exports: {}
    };
    factory(global.react, global.chai, global.enzyme, global.chaiEnzyme, global.sinonChai, global.qa, global.Pagination);
    global.PaginationTest = mod.exports;
  }
})(this, function (_react, _chai, _enzyme, _chaiEnzyme, _sinonChai, _qa, _Pagination) {
  'use strict';

  var _react2 = _interopRequireDefault(_react);

  var _chai2 = _interopRequireDefault(_chai);

  var _chaiEnzyme2 = _interopRequireDefault(_chaiEnzyme);

  var _sinonChai2 = _interopRequireDefault(_sinonChai);

  var _Pagination2 = _interopRequireDefault(_Pagination);

  function _interopRequireDefault(obj) {
    return obj && obj.__esModule ? obj : {
      default: obj
    };
  }

  _chai2.default.use((0, _chaiEnzyme2.default)());
  _chai2.default.use(_sinonChai2.default);

  describe('Pagination component', function () {
    var actions = {
      onChange: function onChange() {}
    };

    it('can create an instance', function () {
      var wrapper = (0, _enzyme.shallow)(_react2.default.createElement(_Pagination2.default, { activePage: 1, pageCount: 1, onChange: actions.onChange }));
      (0, _chai.expect)(wrapper).to.be.present();
    });

    describe('is hidden under certain circumstances', function () {
      it('hides when only single page', function () {
        var wrapper = (0, _enzyme.mount)(_react2.default.createElement(_Pagination2.default, { activePage: 1, pageCount: 1, onChange: actions.onChange }));
        (0, _chai.expect)(wrapper.find('.pagination')).to.not.be.present();
      });

      it('hides previous spread', function () {
        var wrapperHidden = (0, _enzyme.mount)(_react2.default.createElement(_Pagination2.default, { activePage: 1, pageCount: 5, onChange: actions.onChange }));
        var wrapperShown = (0, _enzyme.mount)(_react2.default.createElement(_Pagination2.default, { activePage: 3, pageCount: 5, onChange: actions.onChange }));
        (0, _chai.expect)(wrapperHidden.find((0, _qa.select)('pagination-spread--previous'))).to.not.be.present();
        (0, _chai.expect)(wrapperShown.find((0, _qa.select)('pagination-spread--previous'))).to.be.present();
      });

      it('hides next spread', function () {
        var wrapperHidden = (0, _enzyme.mount)(_react2.default.createElement(_Pagination2.default, { activePage: 5, pageCount: 5, onChange: actions.onChange }));
        var wrapperShown = (0, _enzyme.mount)(_react2.default.createElement(_Pagination2.default, { activePage: 3, pageCount: 5, onChange: actions.onChange }));
        (0, _chai.expect)(wrapperHidden.find((0, _qa.select)('pagination-spread--next'))).to.not.be.present();
        (0, _chai.expect)(wrapperShown.find((0, _qa.select)('pagination-spread--next'))).to.be.present();
      });
    });

    describe('shows correct number of children', function () {
      it('two pages', function () {
        var wrapper = (0, _enzyme.mount)(_react2.default.createElement(_Pagination2.default, { activePage: 1, pageCount: 2, onChange: actions.onChange }));
        (0, _chai.expect)(wrapper.find((0, _qa.select)('pagination-page')).length).to.equal(2);
      });

      it('max three pages', function () {
        var wrapperThree = (0, _enzyme.mount)(_react2.default.createElement(_Pagination2.default, { activePage: 1, pageCount: 3, onChange: actions.onChange }));
        var wrapperFive = (0, _enzyme.mount)(_react2.default.createElement(_Pagination2.default, { activePage: 1, pageCount: 5, onChange: actions.onChange }));
        (0, _chai.expect)(wrapperThree.find((0, _qa.select)('pagination-page')).length).to.equal(3);
        (0, _chai.expect)(wrapperFive.find((0, _qa.select)('pagination-page')).length).to.equal(3);
      });
    });

    describe('shows correct active', function () {
      it('first page active', function () {
        var wrapper = (0, _enzyme.mount)(_react2.default.createElement(_Pagination2.default, { activePage: 1, pageCount: 5, onChange: actions.onChange }));
        (0, _chai.expect)(wrapper.find((0, _qa.select)('pagination-page')).first()).to.have.descendants('span');
        (0, _chai.expect)(wrapper.find((0, _qa.select)('pagination-page')).at(1)).to.have.descendants('a');
        (0, _chai.expect)(wrapper.find((0, _qa.select)('pagination-page')).last()).to.have.descendants('a');
        (0, _chai.expect)(wrapper.find((0, _qa.select)('pagination-first'))).to.have.descendants('span');
        (0, _chai.expect)(wrapper.find((0, _qa.select)('pagination-last'))).to.have.descendants('a');
      });

      it('middle page active', function () {
        var wrapper = (0, _enzyme.mount)(_react2.default.createElement(_Pagination2.default, { activePage: 3, pageCount: 5, onChange: actions.onChange }));
        (0, _chai.expect)(wrapper.find((0, _qa.select)('pagination-page')).first()).to.have.descendants('a');
        (0, _chai.expect)(wrapper.find((0, _qa.select)('pagination-page')).at(1)).to.have.descendants('span');
        (0, _chai.expect)(wrapper.find((0, _qa.select)('pagination-page')).last()).to.have.descendants('a');
        (0, _chai.expect)(wrapper.find((0, _qa.select)('pagination-first'))).to.have.descendants('a');
        (0, _chai.expect)(wrapper.find((0, _qa.select)('pagination-last'))).to.have.descendants('a');
      });

      it('last page active', function () {
        var wrapper = (0, _enzyme.mount)(_react2.default.createElement(_Pagination2.default, { activePage: 5, pageCount: 5, onChange: actions.onChange }));
        (0, _chai.expect)(wrapper.find((0, _qa.select)('pagination-page')).first()).to.have.descendants('a');
        (0, _chai.expect)(wrapper.find((0, _qa.select)('pagination-page')).at(1)).to.have.descendants('a');
        (0, _chai.expect)(wrapper.find((0, _qa.select)('pagination-page')).last()).to.have.descendants('span');
        (0, _chai.expect)(wrapper.find((0, _qa.select)('pagination-first'))).to.have.descendants('a');
        (0, _chai.expect)(wrapper.find((0, _qa.select)('pagination-last'))).to.have.descendants('span');
      });
    });

    describe('onClick', function () {
      var sandbox = sinon.sandbox.create();

      afterEach(function () {
        sandbox.restore();
      });

      it('first link', function () {
        var spyClick = sandbox.spy(actions, 'onChange');
        var wrapper = (0, _enzyme.mount)(_react2.default.createElement(_Pagination2.default, { activePage: 3, pageCount: 5, onChange: actions.onChange }));
        wrapper.find((0, _qa.select)('pagination-first')).find('a').simulate('click');
        (0, _chai.expect)(spyClick).to.have.been.calledOnce;
        (0, _chai.expect)(spyClick).to.have.been.calledWith(1);
      });

      it('last link', function () {
        var spyClick = sandbox.spy(actions, 'onChange');
        var wrapper = (0, _enzyme.mount)(_react2.default.createElement(_Pagination2.default, { activePage: 3, pageCount: 5, onChange: actions.onChange }));
        wrapper.find((0, _qa.select)('pagination-last')).find('a').simulate('click');
        (0, _chai.expect)(spyClick).to.have.been.calledOnce;
        (0, _chai.expect)(spyClick).to.have.been.calledWith(5);
      });

      it('previous page item', function () {
        var spyClick = sandbox.spy(actions, 'onChange');
        var wrapper = (0, _enzyme.mount)(_react2.default.createElement(_Pagination2.default, { activePage: 3, pageCount: 5, onChange: actions.onChange }));
        wrapper.find((0, _qa.select)('pagination-page')).first().find('a').simulate('click');
        (0, _chai.expect)(spyClick).to.have.been.calledOnce;
        (0, _chai.expect)(spyClick).to.have.been.calledWith(2);
      });

      it('next page item', function () {
        var spyClick = sandbox.spy(actions, 'onChange');
        var wrapper = (0, _enzyme.mount)(_react2.default.createElement(_Pagination2.default, { activePage: 3, pageCount: 5, onChange: actions.onChange }));
        wrapper.find((0, _qa.select)('pagination-page')).last().find('a').simulate('click');
        (0, _chai.expect)(spyClick).to.have.been.calledOnce;
        (0, _chai.expect)(spyClick).to.have.been.calledWith(4);
      });
    });
  });
});