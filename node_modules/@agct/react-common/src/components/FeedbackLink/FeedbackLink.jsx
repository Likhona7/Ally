import React, { PropTypes } from 'react';

const generateEmail = (userAgent, username, date, url) => (
  `%0A\
-------------------------------------------------------%0A\
Your feedback is greatly appreciated.%0A\
If you are experiencing a problem or have a suggestion, \
please be as specific as possible and include a screenshot where necessary.%0A%0A\
Technical Data:%0A\
user-agent: ${userAgent} \
url: ${url} \
screen-resolution: ${window.outerWidth}x${window.outerHeight} \
username: ${username} \
timestamp: ${date}`
  );

const sendEmail = (app, userAgent, username, date, url) => {
  window.open(
    `mailto:icebreakersfeedback@allangray.co.za?Subject=[${app} Feedback]
    &body=${generateEmail(userAgent, username, date, url)}`,
        'emailWindow', '_self');
};

const FeedbackLink = ({ app, userAgent, username, date = new Date(), url = window.location.href }) => {
  const onClick = (e) => {
    e.preventDefault();
    sendEmail(app, userAgent, username, date, url);
  };

  return (
    <a
      className="nav-bar__items__item"
      onClick={onClick}
    >
      Send us your Feedback
    </a>
  );
};

FeedbackLink.propTypes = {
  app: PropTypes.string.isRequired,
  userAgent: PropTypes.string.isRequired,
  username: PropTypes.string.isRequired,
  date: PropTypes.object,
  url: PropTypes.string,
};

export default FeedbackLink;
